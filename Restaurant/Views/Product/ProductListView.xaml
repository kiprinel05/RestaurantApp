<Page x:Class="Restaurant.Views.ProductListView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:vm="clr-namespace:Restaurant.ViewModels"
      mc:Ignorable="d"
      Title="Product Management"
      d:DataContext="{d:DesignInstance Type=vm:ProductListViewModel}"
      Background="{StaticResource PrimaryBackgroundBrush}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Product Management"
                 Style="{StaticResource HeaderText}"
                 HorizontalAlignment="Center"
                 Margin="0,0,0,20"/>

        <!-- Error Message -->
        <TextBlock Grid.Row="1"
                 Text="{Binding ErrorMessage}"
                 Style="{StaticResource FormErrorStyle}"
                 Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}"
                 Margin="0,0,0,20"/>

        <!-- Content -->
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Actions -->
            <StackPanel Orientation="Horizontal"
                      Margin="0,0,0,20">
                <Button Content="Add Product"
                        Command="{Binding AddProductCommand}"
                        Style="{StaticResource FormSubmitButtonStyle}"/>
                <Button Content="Refresh"
                        Command="{Binding RefreshCommand}"
                        Style="{StaticResource FormCancelButtonStyle}"/>
            </StackPanel>

            <!-- Products List -->
            <DataGrid Grid.Row="1"
                      ItemsSource="{Binding Products}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      GridLinesVisibility="Horizontal"
                      BorderThickness="1"
                      BorderBrush="#E0E0E0"
                      Background="White"
                      RowBackground="White"
                      AlternatingRowBackground="#F5F5F5">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Name" 
                                      Binding="{Binding Name}"
                                      Width="*"/>
                    <DataGridTextColumn Header="Price" 
                                      Binding="{Binding Price, StringFormat=C2}"
                                      Width="100"/>
                    <DataGridTextColumn Header="Category" 
                                      Binding="{Binding Category.Name}"
                                      Width="150"/>
                    <DataGridTextColumn Header="Quantity" 
                                      Binding="{Binding TotalQuantity}"
                                      Width="100"/>
                    <DataGridCheckBoxColumn Header="Available" 
                                          Binding="{Binding IsAvailable}"
                                          Width="80"/>
                    <DataGridTemplateColumn Header="Actions" Width="200">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="Edit"
                                            Command="{Binding DataContext.EditProductCommand, 
                                                    RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            CommandParameter="{Binding}"
                                            Style="{StaticResource FormSubmitButtonStyle}"
                                            Width="80"
                                            Margin="0,0,10,0"/>
                                    <Button Content="Delete"
                                            Command="{Binding DataContext.DeleteProductCommand,
                                                    RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            CommandParameter="{Binding}"
                                            Style="{StaticResource FormCancelButtonStyle}"
                                            Width="80"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

        <!-- Loading Overlay -->
        <Grid Grid.RowSpan="3"
              Background="#88000000"
              Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center"
                      VerticalAlignment="Center">
                <TextBlock Text="Loading..."
                         Style="{StaticResource HeaderText}"
                         Foreground="White"/>
                <ProgressBar IsIndeterminate="True"
                           Width="200"
                           Height="2"
                           Margin="0,10,0,0"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page> 